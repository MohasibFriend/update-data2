function e(e) { const t = document.createElement("script"); t.type = "text/javascript", t.src = chrome.runtime.getURL(e), t.defer = "defer", (document.body || document.head || document.documentElement).appendChild(t) } function t(e) { const t = document.createElement("link"); t.rel = "stylesheet", t.type = "text/css", t.href = chrome.runtime.getURL(e), (document.body || document.head || document.documentElement).appendChild(t) } t("css/bootstrap.min.css"), t("css/style.css"); const n = JSON.parse(localStorage.getItem("USER_DATA")); if (n && n.profile && n.profile.name) s(n.profile.name.toLowerCase()); else { let e; const t = setInterval(() => { e = document.getElementById("tooltip1"), e && (clearInterval(t), s(e.innerText.toLowerCase())) }, 100) } function s(t) { chrome.runtime.sendMessage({ action: "setActiveUser", email: t }), e("scripts/extensionBase.min.js"), e("scripts/jszip.min.js"), e("scripts/polyfill.js"), setTimeout(() => { e("scripts/exceljs/exceljs.min.js") }, 2e3) } window.addEventListener("RequestExtensionData", e => { chrome.runtime.sendMessage({ action: "checkStatusAndDownload" }, e => { if (e) { const t = new CustomEvent("ReceiveExtensionData", { detail: e }); window.dispatchEvent(t) } }) });